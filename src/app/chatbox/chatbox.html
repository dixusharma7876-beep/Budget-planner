<!-- Chat Window -->
<div class="chat-window" *ngIf="isOpen">
  
  <!-- Header -->
  <div class="chat-header">
    <div class="avatar">ğŸ¤–</div>
    <div class="header-info">
      <div class="bot-name">Budget Assistant</div>
      <div class="bot-status">â— Online</div>
    </div>
    <button class="close-btn" (click)="toggleChat()">âœ•</button>
  </div>

  <!-- Messages Area -->
  <div class="chat-messages" #messagesContainer>
    <div *ngFor="let msg of messages" 
         class="message-wrapper" 
         [class.user-wrapper]="msg.role === 'user'"
         [class.bot-wrapper]="msg.role === 'bot'">
      
      <div class="message" [class.user-msg]="msg.role === 'user'" [class.bot-msg]="msg.role === 'bot'">
        {{ msg.text }}
      </div>
    </div>

    <!-- Typing Indicator -->
    <div class="message-wrapper bot-wrapper" *ngIf="isTyping">
      <div class="message bot-msg typing-indicator">
        <span></span><span></span><span></span>
      </div>
    </div>
  </div>

  <!-- Input Area -->
  <div class="chat-input-area">
    <input 
      type="text" 
      class="chat-input"
      [(ngModel)]="userInput"
      (keyup)="onEnter($event)"
      placeholder="Type your message..."
      [disabled]="isTyping"
    />
    <button class="send-btn" (click)="sendMessage()" [disabled]="isTyping || !userInput.trim()">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="22" y1="2" x2="11" y2="13"></line>
        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
      </svg>
    </button>
  </div>

</div>

<!-- Floating Chat Button (Bottom Right) -->
<button class="chat-toggle" (click)="toggleChat()" [class.active]="isOpen">
  <svg *ngIf="!isOpen" xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
  </svg>
  <svg *ngIf="isOpen" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <line x1="18" y1="6" x2="6" y2="18"></line>
    <line x1="6" y1="6" x2="18" y2="18"></line>
  </svg>
</button>